<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<VBox spacing="20.0" styleClass="root"
      stylesheets="@styles/access_control_view_styles.css"
      xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.example.quanlytoanha.controller.AccessControlController">

    <padding><Insets top="25" right="25" bottom="25" left="25"/></padding>

    <HBox alignment="CENTER_LEFT" spacing="15.0" style="-fx-border-width: 0 0 2 0; -fx-border-color: transparent transparent #e0e0e0 transparent; -fx-padding: 0 0 15 0;">
        <Label text="ðŸ›¡ï¸ KIá»‚M SOÃT AN NINH RA/VÃ€O" styleClass="header-label"/>
    </HBox>

    <TabPane VBox.vgrow="ALWAYS" tabClosingPolicy="UNAVAILABLE">
        <tabs>
            <Tab text="ðŸš— Ghi nháº­n Xe">
                <content>
                    <VBox spacing="20.0" styleClass="content-card">
                        <children>
                            <Label text="ThÃ´ng tin Xe Ra/VÃ o" styleClass="section-title"/>

                            <GridPane hgap="20" vgap="15">
                                <columnConstraints>
                                    <ColumnConstraints hgrow="NEVER" minWidth="120.0"/>
                                    <ColumnConstraints hgrow="ALWAYS"/>
                                </columnConstraints>

                                <Label text="Biá»ƒn sá»‘ xe (*):" GridPane.rowIndex="0" styleClass="field-label"/>
                                <TextField fx:id="txtLicensePlate" promptText="VD: 29A-123.45" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                                <Label text="Loáº¡i xe:" GridPane.rowIndex="1" styleClass="field-label"/>
                                <ComboBox fx:id="cmbVehicleType" promptText="-- Chá»n loáº¡i xe --" maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                                <Label text="HÃ nh Ä‘á»™ng (*):" GridPane.rowIndex="2" styleClass="field-label"/>
                                <ComboBox fx:id="cmbAccessType" promptText="-- Chá»n IN / OUT --" maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                                <Label text="Ghi chÃº:" GridPane.rowIndex="3" styleClass="field-label"/>
                                <TextField fx:id="txtVehicleNotes" promptText="VD: Giao hÃ ng cho cÄƒn há»™ 101" GridPane.columnIndex="1" GridPane.rowIndex="3"/>
                            </GridPane>

                            <HBox alignment="CENTER_RIGHT">
                                <Button fx:id="btnLogVehicle" text="ðŸ’¾ Ghi nháº­n Xe" onAction="#handleLogVehicleAccess" styleClass="btn-primary"/>
                            </HBox>
                        </children>
                    </VBox>
                </content>
            </Tab>

            <Tab text="ðŸ‘¤ Ghi nháº­n KhÃ¡ch">
                <content>
                    <VBox spacing="20.0" styleClass="content-card">
                        <children>
                            <Label text="Check-in KhÃ¡ch (Äi bá»™)" styleClass="section-title"/>

                            <GridPane hgap="20" vgap="15">
                                <columnConstraints>
                                    <ColumnConstraints hgrow="NEVER" minWidth="120.0"/>
                                    <ColumnConstraints hgrow="ALWAYS"/>
                                </columnConstraints>

                                <Label text="TÃªn khÃ¡ch (*):" GridPane.rowIndex="0" styleClass="field-label"/>
                                <TextField fx:id="txtVisitorName" promptText="Nháº­p há» tÃªn khÃ¡ch" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                                <Label text="CCCD/CMND:" GridPane.rowIndex="1" styleClass="field-label"/>
                                <TextField fx:id="txtVisitorIdCard" promptText="Sá»‘ giáº¥y tá» tÃ¹y thÃ¢n" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                                <Label text="Äiá»‡n thoáº¡i:" GridPane.rowIndex="2" styleClass="field-label"/>
                                <TextField fx:id="txtVisitorPhone" promptText="Sá»‘ Ä‘iá»‡n thoáº¡i liÃªn há»‡" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                                <Label text="Äáº¿n cÄƒn há»™:" GridPane.rowIndex="3" styleClass="field-label"/>
                                <ComboBox fx:id="cmbVisitorApartment" promptText="-- Chá»n cÄƒn há»™ --" maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="3"/>

                                <Label text="LÃ½ do:" GridPane.rowIndex="4" styleClass="field-label"/>
                                <TextField fx:id="txtVisitorReason" promptText="VD: ThÄƒm ngÆ°á»i thÃ¢n, Giao hÃ ng..." GridPane.columnIndex="1" GridPane.rowIndex="4"/>
                            </GridPane>

                            <HBox alignment="CENTER_RIGHT">
                                <Button fx:id="btnCheckInVisitor" text="âœ… Check-in KhÃ¡ch" onAction="#handleCheckInVisitor" styleClass="btn-success"/>
                            </HBox>
                        </children>
                    </VBox>
                </content>
            </Tab>

            <Tab text="ðŸ” Tra cá»©u Lá»‹ch sá»­">
                <content>
                    <VBox spacing="15.0" styleClass="content-card">
                        <children>
                            <HBox spacing="15.0" alignment="BOTTOM_LEFT" style="-fx-background-color: #f8f9fa; -fx-padding: 15; -fx-background-radius: 8;">
                                <VBox spacing="5">
                                    <Label text="Tá»« ngÃ y:" styleClass="field-label"/>
                                    <DatePicker fx:id="dpSearchStartDate" prefWidth="160.0"/>
                                </VBox>
                                <VBox spacing="5">
                                    <Label text="Äáº¿n ngÃ y:" styleClass="field-label"/>
                                    <DatePicker fx:id="dpSearchEndDate" prefWidth="160.0"/>
                                </VBox>
                                <Button fx:id="btnSearchLogs" text="ðŸ” Tra cá»©u" onAction="#handleSearchLogs" styleClass="btn-info"/>
                            </HBox>

                            <TabPane VBox.vgrow="ALWAYS" tabClosingPolicy="UNAVAILABLE">
                                <tabs>
                                    <Tab text="Lá»‹ch sá»­ Xe">
                                        <content>
                                            <VBox spacing="10" style="-fx-padding: 10 0 0 0;">
                                                <children>
                                                    <TableView fx:id="tableVehicleLogs" VBox.vgrow="ALWAYS">
                                                        <columns>
                                                            <TableColumn text="Thá»i gian" prefWidth="150.0"><cellValueFactory><PropertyValueFactory property="accessTime" /></cellValueFactory></TableColumn>
                                                            <TableColumn text="Loáº¡i" prefWidth="60.0" style="-fx-alignment: CENTER;"><cellValueFactory><PropertyValueFactory property="accessType" /></cellValueFactory></TableColumn>
                                                            <TableColumn text="Biá»ƒn sá»‘" prefWidth="100.0"><cellValueFactory><PropertyValueFactory property="licensePlate" /></cellValueFactory></TableColumn>
                                                            <TableColumn text="CÆ° dÃ¢n" prefWidth="150.0"><cellValueFactory><PropertyValueFactory property="residentFullName" /></cellValueFactory></TableColumn>
                                                            <TableColumn text="Ghi chÃº" prefWidth="200.0"><cellValueFactory><PropertyValueFactory property="notes" /></cellValueFactory></TableColumn>
                                                            <TableColumn text="Báº£o vá»‡" prefWidth="150.0"><cellValueFactory><PropertyValueFactory property="guardFullName" /></cellValueFactory></TableColumn>
                                                        </columns>
                                                        <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY" /></columnResizePolicy>
                                                    </TableView>
                                                    <HBox alignment="CENTER_RIGHT">
                                                        <Button fx:id="btnExportVehiclePDF" text="ðŸ“¥ Xuáº¥t PDF (Xe)" onAction="#handleExportVehicleLogPDF" disable="true" styleClass="btn-success"/>
                                                    </HBox>
                                                </children>
                                            </VBox>
                                        </content>
                                    </Tab>

                                    <Tab text="Lá»‹ch sá»­ KhÃ¡ch">
                                        <content>
                                            <VBox spacing="10" style="-fx-padding: 10 0 0 0;">
                                                <children>
                                                    <TableView fx:id="tableVisitorLogs" VBox.vgrow="ALWAYS">
                                                        <columns>
                                                            <TableColumn text="Check-in" prefWidth="140.0"><cellValueFactory><PropertyValueFactory property="checkInTime" /></cellValueFactory></TableColumn>
                                                            <TableColumn text="Check-out" prefWidth="140.0"><cellValueFactory><PropertyValueFactory property="checkOutTime" /></cellValueFactory></TableColumn>
                                                            <TableColumn text="TÃªn khÃ¡ch" prefWidth="150.0"><cellValueFactory><PropertyValueFactory property="visitorName" /></cellValueFactory></TableColumn>
                                                            <TableColumn text="CÄƒn há»™" prefWidth="80.0" style="-fx-alignment: CENTER;"><cellValueFactory><PropertyValueFactory property="apartmentId" /></cellValueFactory></TableColumn>
                                                            <TableColumn text="LÃ½ do" prefWidth="180.0"><cellValueFactory><PropertyValueFactory property="reason" /></cellValueFactory></TableColumn>
                                                            <TableColumn text="Báº£o vá»‡" prefWidth="150.0"><cellValueFactory><PropertyValueFactory property="guardFullName" /></cellValueFactory></TableColumn>
                                                        </columns>
                                                        <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY" /></columnResizePolicy>
                                                    </TableView>
                                                    <HBox alignment="CENTER_RIGHT" spacing="10">
                                                        <Button fx:id="btnExportVisitorPDF" text="ðŸ“¥ Xuáº¥t PDF (KhÃ¡ch)" onAction="#handleExportVisitorLogPDF" disable="true" styleClass="btn-success"/>
                                                        <Button fx:id="btnCheckOutSelectedVisitor" text="ðŸšª Check-out KhÃ¡ch" onAction="#handleCheckOutSelectedVisitor" disable="true" styleClass="btn-danger"/>
                                                    </HBox>
                                                </children>
                                            </VBox>
                                        </content>
                                    </Tab>
                                </tabs>
                            </TabPane>
                        </children>
                    </VBox>
                </content>
            </Tab>
        </tabs>
    </TabPane>
</VBox>